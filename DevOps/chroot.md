---
id: chroot
aliases:
  - Chroot
tags: []
---

**Back**
    [[!DevOps]]

- как сокет Беркли
source: [Habr - chroot](https://habr.com/ru/companies/selectel/articles/655485/)

# Chroot
---
**Change root** - системный вызов в Unix-like, который изолиирует процесс и его дочерние процессы, меняя для них корневой каталог '/'.
Это создает виртуальную корневую файловую систему, внутри которой процесс НЕ ВИДИТ реальные файлы за ее пределам.


- Тестирование программ
- Восстановление системы (например, если сломана основная ОС)
- Создание минимальных окружениц для сборки ПО (как в docker)
- Безопасность (ограничение доступа к реальной системе)необх

## Как использовать chroot для тестирования
---

1. Подготовка миминимального окружения

```bash
# Создаем директорию для chroot
mkdir -p ~/chroot-test/{bin,lib,lib64,usr,etc}

# Копируем необходимые бинарные файлы (например bash)
cp /bin/bash ~/chroot-test/bin

# Копируем зависимости (используйте ldd для проверки)
# Для MacOS исползуем otool -L /path/to/file
# dyld_info (для более сложного анализа)
ldd /bin/bash
cp /lib/x86_64-linux-gnu/lintinfo.so.6 ~/chroot-tets/lib/
cp /lib/x86_64-linux-gnu/libc.so.6 ~/chroot-test/lib/
cp /lib64/ld-linux-x86-64.so.2 ~/chroot-test/lib64/
```

2. Запуск chroot
```bash
# Актвивация виртуальной файловой системы
sudo chroot ~/chroot-test /bin/bash
```

## Минусы
---
- Не полная изоляция процессы видны в
   - `ps aux`
   - общая сеть
- Требует ручной натсройки (нужно копировать все зависимости)
- Нет изоляции процессов (в отличие от Docker/namespaces)

