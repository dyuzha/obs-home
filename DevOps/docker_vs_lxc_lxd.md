---
id: docker_vs_lxc_lxd
aliases:
  - Docker vs lxc/lxd
tags: []
---
**Back**
    [[!Docker]]

# Docker vs lxc/lxd
---
Обе технологии предназначены для изоляции процессов, но решают разные задачи и работают на разных уровнях абстракции.

## Архитектура и подход
---
| Критерий      | Docker                               | LXC/LXD                                  |
|---------------|--------------------------------------|------------------------------------------|
| Тип изоляции  | Контейнеры (на уровне процессов)     | Виртуальные машины (легковесные)         |
| Основная цель | Запуск одного процесса (микросервис) | Подлноценная виртуальная ОС              |
| Образы        | Основаны на слоях UnionFS            | Полноценные файловые системы (ZFS/BTRFS) |

Docker - оптимизирован для запуска одно процесса (например, веб-сервера)
LXC/LXD - эмулирует целую виртуальную машину (но без гипервизора)

## Изоляция процессов
---
Docker
- Использует namespaces и cgroups для изоляции процессов
- Все контейнеры работают через общее ядро хоста
- Нет полноценного init процесса (PID 1 - это ваш сервис)

LXC/LXD
- Использует namespaces и cgroups для изоляции процессов, но эмулирует целую ОС
- Есть свой init (systemd, OpenRC и тд)
- Можно запускать несколько сервисов внутри одного контейнера

Пример
- Docker нужно запускать  nginx как отдельный контейнер
- D LXC можно запустить nginx, MySQL и cron в одном контейнере


## Управление образами
---
| Критерий         | Docker                     | LXC/LXD                                   |
|------------------|----------------------------|-------------------------------------------|
| Хранение образов | Docker Hub (репозиторий)   | Официальные образы Linux (Ubuntu, Alpine) |
| Слоистость       | Да (кеширование слоев)     | Нет (полные образы)                       |
| Размер образа    | Минимальный (Alpine ~5 МБ) | Обычно больше (Ubuntu ~ 100 МБ)           |

Docker выигрывает за счет:
- Многослойных образов (кеширование)
- Огомное количество готовых образов (nginx, postgres, ...)

LXC/LXD ближе к классическим виртуальным машинами
- Полноценная ОС внутри
- Можно обновлять пакеты (apt upgrade)


## Сетевые возможности
---
| Критерий          | Docker                            | LXC/LXD                             |
|-------------------|-----------------------------------|-------------------------------------|
| Сеть по умолчанию | NAT (bridge)                      | NAT или мост (bridge)               |
| Гибкость          | Docker Network (overlay, macvlan) | Поддержка VLAN, IPv6, маршрутизации |
| Firewall          | iptables/nftables                 | Может использовать nftables         |

LXC дает больше контроля на сетью, как в классических VM


## Безопасность
---
| Критерий         | Docker                         | LXC/LXD                           |
|------------------|--------------------------------|-----------------------------------|
| Изоляция         | Процессная (namespaces)        | Ближе к VN (но без гипервизора)   |
| Root-доступ      | По умолчанию root в контейнере | Можно запускать без root (userns) |
| AppArmor/SELinux | Поддерживается                 | Поддерживается                    |

Проблемы Docker:
- По умолчанию контейнеры работаюь от `root`
- Уязвимости в ядре влияют на все контейнеры

LXC/LXD Безопаснее:
-  Можно запускать от обычного пользователя
- Лучше подходит для мультитенатных сред

## Когда что использовать
---
Docker
- Микросервисы (1 процесс = 1 контейнер)
- CI/CD и деплой приложений
- Готовые образы из Docker Hub

LXC/LXD
- Виртуальные машины без гипервизора
- Тестирование дистрибутивов Linux
- Запуск нескольких сервисов в одном контейнере
